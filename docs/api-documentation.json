{
  "components": {
    "schemas": {
      "Invoice": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "studentId": { "type": "integer" },
          "amount": { "type": "number" },
          "periodMonth": { "type": "integer" },
          "periodYear": { "type": "integer" },
          "dueDate": { "type": "string", "format": "date" },
          "status": { "type": "string", "enum": ["due", "paid", "overdue", "grace_period"] },
          "graceUntil": { "type": "string", "format": "date", "nullable": true }
        }
      },
      "StudentAnalyticsOverview": {
        "type": "object",
        "properties": {
          "assigned": { "type": "integer" },
          "submitted": { "type": "integer" },
          "graded": { "type": "integer" },
          "upcomingDueDates": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "assignmentId": { "type": "integer" },
                "title": { "type": "string" },
                "dueDate": { "type": "string", "format": "date" }
              }
            }
          },
          "attendanceRate": { "type": "number" }
        }
      },
      "Student": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "email": { "type": "string", "format": "email" },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "grade": { "type": "string" },
          "schoolName": { "type": "string" },
          "parentName": { "type": "string" },
          "parentPhone": { "type": "string" },
          "parentEmail": { "type": "string", "format": "email", "nullable": true },
          "subjectsInterested": { "type": "array", "items": { "type": "string" } },
          "monthlyFee": { "type": "number" },
          "paymentStatus": { "type": "string", "enum": ["due", "paid", "overdue", "grace_period"] },
          "enrollmentDate": { "type": "string", "format": "date" },
          "city": { "type": "string" },
          "state": { "type": "string" }
        }
      },
      "Teacher": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "email": { "type": "string", "format": "email", "nullable": true },
          "firstName": { "type": "string" },
          "lastName": { "type": "string" },
          "qualification": { "type": "string" },
          "experienceYears": { "type": "integer" },
          "subjectsTaught": { "type": "array", "items": { "type": "string" } },
          "teachingMode": { "type": "string", "enum": ["online", "offline", "both"] },
          "hourlyRate": { "type": "number", "nullable": true },
          "monthlySalary": { "type": "number", "nullable": true },
          "approvalStatus": { "type": "string", "enum": ["pending", "approved", "rejected"] },
          "rating": { "type": "number", "nullable": true },
          "totalReviews": { "type": "integer", "nullable": true },
          "maxStudents": { "type": "integer", "nullable": true },
          "currentStudents": { "type": "integer", "nullable": true },
          "city": { "type": "string" },
          "state": { "type": "string" }
        }
      },
      "Assignment": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "teacherId": { "type": "integer" },
          "studentId": { "type": "integer" },
          "title": { "type": "string" },
          "description": { "type": "string" },
          "subject": { "type": "string" },
          "dueDate": { "type": "string", "format": "date" },
          "assignmentType": { "type": "string" },
          "maxMarks": { "type": "integer" },
          "status": { "type": "string", "enum": ["assigned", "submitted", "graded", "overdue"] },
          "createdAt": { "type": "string", "format": "date-time" }
        }
      },
      "Submission": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "assignmentId": { "type": "integer" },
          "studentId": { "type": "integer" },
          "submittedAt": { "type": "string", "format": "date-time" },
          "submissionText": { "type": "string", "nullable": true },
          "attachments": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "filename": { "type": "string" },
                "url": { "type": "string", "format": "uri" },
                "size": { "type": "integer" }
              }
            }
          },
          "status": { "type": "string", "enum": ["submitted", "graded"] },
          "marks": { "type": "integer", "nullable": true },
          "feedback": { "type": "string", "nullable": true }
        }
      },
      "Attendance": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "studentId": { "type": "integer" },
          "teacherId": { "type": "integer" },
          "date": { "type": "string", "format": "date" },
          "status": { "type": "string", "enum": ["present", "absent", "excused"] },
          "notes": { "type": "string", "nullable": true },
          "sessionDuration": { "type": "integer", "description": "minutes" },
          "subject": { "type": "string" }
        }
      },
      "Payment": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "studentId": { "type": "integer" },
          "amount": { "type": "number" },
          "paymentType": { "type": "string", "enum": ["monthly_fee", "other"] },
          "paymentMethod": { "type": "string", "enum": ["upi", "card", "netbanking", "cash"] },
          "paymentStatus": { "type": "string", "enum": ["pending", "completed", "failed", "refunded"] },
          "transactionId": { "type": "string", "nullable": true },
          "paymentDate": { "type": "string", "format": "date" },
          "dueDate": { "type": "string", "format": "date", "nullable": true },
          "notes": { "type": "string", "nullable": true }
        }
      },
      "Notification": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "title": { "type": "string" },
          "message": { "type": "string" },
          "type": { "type": "string", "enum": ["assignment", "payment", "attendance", "system"] },
          "priority": { "type": "string", "enum": ["low", "medium", "high"] },
          "isRead": { "type": "boolean" },
          "createdAt": { "type": "string", "format": "date-time" }
        }
      }
    }
  },
  "paths": {
    "/student/me": {
      "get": {
        "tags": ["Student"],
        "summary": "Get current student profile",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Student profile",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Student" } } }
          }
        }
      },
      "put": {
        "tags": ["Student"],
        "summary": "Update current student profile",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/Student" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Student updated",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Student" } } }
          }
        }
      }
    },
    "/student/teachers": {
      "get": {
        "tags": ["Student"],
        "summary": "Discover and list assigned teachers",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } },
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "subject", "in": "query", "schema": { "type": "string" } },
          { "name": "city", "in": "query", "schema": { "type": "string" } },
          { "name": "assignedOnly", "in": "query", "schema": { "type": "boolean", "default": false } }
        ],
        "responses": {
          "200": {
            "description": "Teachers list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "teachers": { "type": "array", "items": { "$ref": "#/components/schemas/Teacher" } },
                    "page": { "type": "integer" },
                    "total": { "type": "integer" },
                    "totalPages": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/teachers/{id}": {
      "get": {
        "tags": ["Teachers"],
        "summary": "Get teacher public profile by ID",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": {
          "200": {
            "description": "Teacher",
            "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Teacher" } } }
          },
          "404": {
            "description": "Teacher not found"
          }
        }
      }
    },
    "/student/assignments": {
      "get": {
        "tags": ["Student"],
        "summary": "List assignments for the student",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          {
            "name": "status",
            "in": "query",
            "schema": { "type": "string", "enum": ["assigned", "submitted", "graded", "overdue"] }
          },
          { "name": "subject", "in": "query", "schema": { "type": "string" } },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
        ],
        "responses": {
          "200": {
            "description": "Assignments list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "assignments": { "type": "array", "items": { "$ref": "#/components/schemas/Assignment" } },
                    "page": { "type": "integer" },
                    "total": { "type": "integer" },
                    "totalPages": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/assignments/{id}": {
      "get": {
        "tags": ["Student"],
        "summary": "Get assignment and student's submission",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": {
          "200": {
            "description": "Assignment with submission",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "assignment": { "$ref": "#/components/schemas/Assignment" },
                    "submission": { "$ref": "#/components/schemas/Submission" }
                  }
                }
              }
            }
          },
          "404": { "description": "Not found" }
        }
      }
    },
    "/assignments/{id}/submit": {
      "post": {
        "tags": ["Student"],
        "summary": "Submit an assignment",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "submissionText": { "type": "string" },
                  "file": { "type": "string", "format": "binary" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Submitted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "submissionId": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/attendance": {
      "get": {
        "tags": ["Student"],
        "summary": "List attendance for the student",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "startDate", "in": "query", "schema": { "type": "string", "format": "date" } },
          { "name": "endDate", "in": "query", "schema": { "type": "string", "format": "date" } },
          { "name": "subject", "in": "query", "schema": { "type": "string" } },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
        ],
        "responses": {
          "200": {
            "description": "Attendance list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "records": { "type": "array", "items": { "$ref": "#/components/schemas/Attendance" } },
                    "page": { "type": "integer" },
                    "total": { "type": "integer" },
                    "totalPages": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/fees": {
      "get": {
        "tags": ["Student"],
        "summary": "List fee invoices for the student",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "year", "in": "query", "schema": { "type": "integer" } },
          { "name": "month", "in": "query", "schema": { "type": "integer", "minimum": 1, "maximum": 12 } },
          {
            "name": "status",
            "in": "query",
            "schema": { "type": "string", "enum": ["due", "paid", "overdue", "grace_period"] }
          }
        ],
        "responses": {
          "200": {
            "description": "Invoices",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "invoices": { "type": "array", "items": { "$ref": "#/components/schemas/Invoice" } }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/payments": {
      "get": {
        "tags": ["Student"],
        "summary": "List student's payments",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "startDate", "in": "query", "schema": { "type": "string", "format": "date" } },
          { "name": "endDate", "in": "query", "schema": { "type": "string", "format": "date" } },
          {
            "name": "status",
            "in": "query",
            "schema": { "type": "string", "enum": ["pending", "completed", "failed", "refunded"] }
          }
        ],
        "responses": {
          "200": {
            "description": "Payments",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "payments": { "type": "array", "items": { "$ref": "#/components/schemas/Payment" } }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/payments": {
      "post": {
        "tags": ["Student"],
        "summary": "Process a student payment",
        "security": [{ "bearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "studentId": { "type": "integer" },
                  "amount": { "type": "number" },
                  "paymentType": { "type": "string", "enum": ["monthly_fee", "other"] },
                  "paymentMethod": { "type": "string", "enum": ["upi", "card", "netbanking", "cash"] },
                  "notes": { "type": "string" }
                },
                "required": ["studentId", "amount", "paymentType", "paymentMethod"]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Payment created",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Payment" }
              }
            }
          }
        }
      }
    },
    "/student/notifications": {
      "get": {
        "tags": ["Student"],
        "summary": "List notifications",
        "security": [{ "bearerAuth": [] }],
        "parameters": [
          { "name": "isRead", "in": "query", "schema": { "type": "boolean" } },
          {
            "name": "type",
            "in": "query",
            "schema": { "type": "string", "enum": ["assignment", "payment", "attendance", "system"] }
          },
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } }
        ],
        "responses": {
          "200": {
            "description": "Notifications",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "notifications": { "type": "array", "items": { "$ref": "#/components/schemas/Notification" } },
                    "page": { "type": "integer" },
                    "total": { "type": "integer" },
                    "totalPages": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/notifications/{id}/read": {
      "patch": {
        "tags": ["Student"],
        "summary": "Mark notification as read",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": {
          "200": {
            "description": "Updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": { "type": "integer" },
                    "isRead": { "type": "boolean" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/history": {
      "get": {
        "tags": ["Student"],
        "summary": "Student progress summary",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Summary",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "assignmentsTotal": { "type": "integer" },
                    "submitted": { "type": "integer" },
                    "graded": { "type": "integer" },
                    "averageMarks": { "type": "number" },
                    "attendanceRate": { "type": "number" },
                    "bySubject": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "subject": { "type": "string" },
                          "avgMarks": { "type": "number" },
                          "attendanceRate": { "type": "number" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/student/analytics/overview": {
      "get": {
        "tags": ["Student"],
        "summary": "Student KPIs",
        "security": [{ "bearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Overview",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/StudentAnalyticsOverview" }
              }
            }
          }
        }
      }
    },
    "/student/analytics/monthly": {
      "get": {
        "tags": ["Student"],
        "summary": "Monthly series",
        "security": [{ "bearerAuth": [] }],
        "parameters": [{ "name": "year", "in": "query", "schema": { "type": "integer" } }],
        "responses": {
          "200": {
            "description": "Series",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "months": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "month": { "type": "string" },
                          "assigned": { "type": "integer" },
                          "submitted": { "type": "integer" },
                          "graded": { "type": "integer" },
                          "attendanceRate": { "type": "number" }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
